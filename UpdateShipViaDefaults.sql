
--EDI Ship Via Xref
SELECT * FROM dbo.edcshvfl_sql AS ES

--Old Progression View (for cross-reference)
SELECT * FROM dbo.araltadr_sql AS [AS]

--ES table storing all addresses in the database (delivery, billing, etc for both vendors and customers)
SELECT * FROM ADDRESSES WHERE TYPE = 'DEL' AND shipvia = 'CWF'

--UPDATE dbo.Addresses 
--SET ShipVia = 'FTW'
--WHERE type = 'DEL' AND shipvia = '0'
 
 
--ES table storing customer data  (sort of replaces old ARCUSFIL table in Progression)
SELECT * FROM dbo.cicmpy 
WHERE LTRIM(cmp_code) = '123' AND (debcode IS NOT NULL) AND ShipVia = 'TBD'

--UPDATE dbo.cicmpy
--SET ShipVia = 'FTW'
--WHERE (debcode IS NOT NULL) AND ShipVia = 'TBD'



--Join Address table on Routing Guide import and run update
SELECT Addresses.shipVia, [Primary], c.ShipVia, * 
FROM dbo.Addresses JOIN [bg_routingguide2012] AS BG ON BG.State = Addresses.StateCode 
				   JOIN dbo.cicmpy AS C ON C.cmp_wwn = Addresses.account
WHERE type = 'DEL' AND NOT(cmp_name LIKE 'WM%'
      OR    cmp_name LIKE 'WALMART%'
      OR    cmp_name LIKE 'WAL-MART%'
      OR   (LTRIM(cmp_code) IN 
		('20703', '4865', '6484', '6173', '738', '4855', '7390', '23005', '26981', '3608', '20774', '722', '1705', '1710', '1715', '1720', '1721', 
'1723', '1724', '1725', '1730', '1731', '1732', '1735', '1740', '1741', '1745', '1750', '4135', '4250', '5447', '5449', '5539', '5550', '6476', '6764', '6825', '7277', '7425', '7722', 
'8265', '8688', '9995', '10244', '22267', '22418', '1054', '1057', '1066', '1067', '1068', '1069', '1070', '1071', '1072', '1073', '1074', '1075', '1076', '1077', '1078', '1079', '1081', 
'1096', '1103', '1111', '1174', '1285', '3532', '3659', '4022', '4024', '4081', '4088', '4089', '4091', '4096', '4113', '4140', '4253', '4329', '4346', '4497', '4511', '4574', '4992', '4993', 
'4997', '5026', '5027', '5046', '5077', '5078', '5109', '5112', '5139', '5142', '5154', '5168', '5196', '5284', '5477', '5547', '5548', '5574', '5602', '5694', '6159', '6355', '6356', '6357', 
'6453', '6989', '7013', '7019', '7020', '7065', '7193', '7252', '7349', '7704', '7878', '9287', '10032', '10160', '10193', '10268', '10395', '21137', '21461', '21467', '22084', '22415', '22622', 
'22969', '222231', '262', '263', '268', '497', '2108', '2310', '2337', '2338', '2339', '2555', '3132', '3467', '3468', '3469', '3487', '3490', '3491', '3493', '3545', '3548', '3549', '3550', 
'3556', '3569', '3571', '3573', '3575', '3643', '3646', '3665', '3667', '3669', '3670', '3672', '3673', '3679', '3681', '3682', '3684', '3689', '3692', '3693', '3695', '3696', '3699', '3701', 
'3703', '3704', '3705', '3707', '3739', '3763', '3796', '3849', '4042', '4057', '4074', '4109', '4222', '4223', '4305', '4352', '4370', '4419', '4502', '4523', '4577', '4581', '4815', '4837', 
'4885', '4888', '4923', '4943', '4952', '5140', '5248', '5249', '5250', '5278', '5470', '6480', '7171', '7376', '9233', '9322', '9328', '9329', '9330', '9331', '9332', '9334', '9335', '9336', 
'9337', '9338', '9339', '9340', '9341', '9342', '9343', '9345', '9346', '9347', '9348', '9349', '9351', '9353', '9354', '9355', '9356', '9357', '9359', '9360', '9361', '9362', '9650', '10041', 
'10066', '10192', '10229', '10333', '10337', '10339', '10340', '10341', '10342', '10343', '10346', '10347', '10348', '10349', '10350', '10351', '10355', '10366', '10370', '10397', '10399', '10536', 
'10624', '20359', '20506', '20509', '20511', '20777', '20878', '20989', '21007', '21012', '21169', '21189', '21191', '21407', '22212', '22254', '22255', '22299', '22352', '22584', '22925', '22989', 
'25500', '30902', '32253', '32290', '100034', '21192', '10353', '10186', '10010', '9350', '9344', '9324', '9323', '4522', '3688', '3677', '3570', '3274', '20888', '20706', '4884' ,'5554', '6491', 
'980', '981', '1098', '6206', '22888', '30124', '5351', '768', '7459')))

UPDATE dbo.Addresses
SET shipVia = [Primary]
FROM dbo.Addresses JOIN [bg_routingguide2012] AS BG ON BG.State = Addresses.StateCode  JOIN dbo.cicmpy AS C ON C.cmp_wwn = Addresses.Account
WHERE type = 'DEL' AND NOT(cmp_name LIKE 'WM%'
      OR    cmp_name LIKE 'WALMART%'
      OR    cmp_name LIKE 'WAL-MART%'
      OR   (LTRIM(cmp_code) IN 
		('20703', '4865', '6484', '6173', '738', '4855', '7390', '23005', '26981', '3608', '20774', '722', '1705', '1710', '1715', '1720', '1721', 
'1723', '1724', '1725', '1730', '1731', '1732', '1735', '1740', '1741', '1745', '1750', '4135', '4250', '5447', '5449', '5539', '5550', '6476', '6764', '6825', '7277', '7425', '7722', 
'8265', '8688', '9995', '10244', '22267', '22418', '1054', '1057', '1066', '1067', '1068', '1069', '1070', '1071', '1072', '1073', '1074', '1075', '1076', '1077', '1078', '1079', '1081', 
'1096', '1103', '1111', '1174', '1285', '3532', '3659', '4022', '4024', '4081', '4088', '4089', '4091', '4096', '4113', '4140', '4253', '4329', '4346', '4497', '4511', '4574', '4992', '4993', 
'4997', '5026', '5027', '5046', '5077', '5078', '5109', '5112', '5139', '5142', '5154', '5168', '5196', '5284', '5477', '5547', '5548', '5574', '5602', '5694', '6159', '6355', '6356', '6357', 
'6453', '6989', '7013', '7019', '7020', '7065', '7193', '7252', '7349', '7704', '7878', '9287', '10032', '10160', '10193', '10268', '10395', '21137', '21461', '21467', '22084', '22415', '22622', 
'22969', '222231', '262', '263', '268', '497', '2108', '2310', '2337', '2338', '2339', '2555', '3132', '3467', '3468', '3469', '3487', '3490', '3491', '3493', '3545', '3548', '3549', '3550', 
'3556', '3569', '3571', '3573', '3575', '3643', '3646', '3665', '3667', '3669', '3670', '3672', '3673', '3679', '3681', '3682', '3684', '3689', '3692', '3693', '3695', '3696', '3699', '3701', 
'3703', '3704', '3705', '3707', '3739', '3763', '3796', '3849', '4042', '4057', '4074', '4109', '4222', '4223', '4305', '4352', '4370', '4419', '4502', '4523', '4577', '4581', '4815', '4837', 
'4885', '4888', '4923', '4943', '4952', '5140', '5248', '5249', '5250', '5278', '5470', '6480', '7171', '7376', '9233', '9322', '9328', '9329', '9330', '9331', '9332', '9334', '9335', '9336', 
'9337', '9338', '9339', '9340', '9341', '9342', '9343', '9345', '9346', '9347', '9348', '9349', '9351', '9353', '9354', '9355', '9356', '9357', '9359', '9360', '9361', '9362', '9650', '10041', 
'10066', '10192', '10229', '10333', '10337', '10339', '10340', '10341', '10342', '10343', '10346', '10347', '10348', '10349', '10350', '10351', '10355', '10366', '10370', '10397', '10399', '10536', 
'10624', '20359', '20506', '20509', '20511', '20777', '20878', '20989', '21007', '21012', '21169', '21189', '21191', '21407', '22212', '22254', '22255', '22299', '22352', '22584', '22925', '22989', 
'25500', '30902', '32253', '32290', '100034', '21192', '10353', '10186', '10010', '9350', '9344', '9324', '9323', '4522', '3688', '3677', '3570', '3274', '20888', '20706', '4884' ,'5554', '6491', 
'980', '981', '1098', '6206', '22888', '30124', '5351', '768', '7459')))



SELECT * 
FROM dbo.Addresses  JOIN dbo.cicmpy AS C ON C.cmp_wwn = Addresses.Account
WHERE type = 'DEL' AND Addresses.ShipVia = 'CWF' AND NOT(cmp_name LIKE 'WM%'
      OR    cmp_name LIKE 'WALMART%'
      OR    cmp_name LIKE 'WAL-MART%'
      OR   (LTRIM(cmp_code) IN 
		('20703', '4865', '6484', '6173', '738', '4855', '7390', '23005', '26981', '3608', '20774', '722', '1705', '1710', '1715', '1720', '1721', 
'1723', '1724', '1725', '1730', '1731', '1732', '1735', '1740', '1741', '1745', '1750', '4135', '4250', '5447', '5449', '5539', '5550', '6476', '6764', '6825', '7277', '7425', '7722', 
'8265', '8688', '9995', '10244', '22267', '22418', '1054', '1057', '1066', '1067', '1068', '1069', '1070', '1071', '1072', '1073', '1074', '1075', '1076', '1077', '1078', '1079', '1081', 
'1096', '1103', '1111', '1174', '1285', '3532', '3659', '4022', '4024', '4081', '4088', '4089', '4091', '4096', '4113', '4140', '4253', '4329', '4346', '4497', '4511', '4574', '4992', '4993', 
'4997', '5026', '5027', '5046', '5077', '5078', '5109', '5112', '5139', '5142', '5154', '5168', '5196', '5284', '5477', '5547', '5548', '5574', '5602', '5694', '6159', '6355', '6356', '6357', 
'6453', '6989', '7013', '7019', '7020', '7065', '7193', '7252', '7349', '7704', '7878', '9287', '10032', '10160', '10193', '10268', '10395', '21137', '21461', '21467', '22084', '22415', '22622', 
'22969', '222231', '262', '263', '268', '497', '2108', '2310', '2337', '2338', '2339', '2555', '3132', '3467', '3468', '3469', '3487', '3490', '3491', '3493', '3545', '3548', '3549', '3550', 
'3556', '3569', '3571', '3573', '3575', '3643', '3646', '3665', '3667', '3669', '3670', '3672', '3673', '3679', '3681', '3682', '3684', '3689', '3692', '3693', '3695', '3696', '3699', '3701', 
'3703', '3704', '3705', '3707', '3739', '3763', '3796', '3849', '4042', '4057', '4074', '4109', '4222', '4223', '4305', '4352', '4370', '4419', '4502', '4523', '4577', '4581', '4815', '4837', 
'4885', '4888', '4923', '4943', '4952', '5140', '5248', '5249', '5250', '5278', '5470', '6480', '7171', '7376', '9233', '9322', '9328', '9329', '9330', '9331', '9332', '9334', '9335', '9336', 
'9337', '9338', '9339', '9340', '9341', '9342', '9343', '9345', '9346', '9347', '9348', '9349', '9351', '9353', '9354', '9355', '9356', '9357', '9359', '9360', '9361', '9362', '9650', '10041', 
'10066', '10192', '10229', '10333', '10337', '10339', '10340', '10341', '10342', '10343', '10346', '10347', '10348', '10349', '10350', '10351', '10355', '10366', '10370', '10397', '10399', '10536', 
'10624', '20359', '20506', '20509', '20511', '20777', '20878', '20989', '21007', '21012', '21169', '21189', '21191', '21407', '22212', '22254', '22255', '22299', '22352', '22584', '22925', '22989', 
'25500', '30902', '32253', '32290', '100034', '21192', '10353', '10186', '10010', '9350', '9344', '9324', '9323', '4522', '3688', '3677', '3570', '3274', '20888', '20706', '4884' ,'5554', '6491', 
'980', '981', '1098', '6206', '22888', '30124', '5351', '768', '7459')))







UPDATE dbo.Addresses
SET shipVia = 'SAI'
WHERE ShipVia = 'SFL' AND StateCode IN ('MS','GA','NC')

SELECT * FROM dbo.Addresses WHERE ShipVia = 'SFL' AND StateCode IN ('MS','GA','NC')